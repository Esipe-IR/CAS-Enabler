{% extends 'base.iframe.html.twig' %}

{% block body %}
{% endblock %}

{% block javascripts %}
    <script>
        var $chan = Channel.build({
            window: window.opener,
            origin: "*",
            scope: "CAS.Scope"
        });

        {% set method = "error" %}
        {% set params = action %}

        {% if not action %}
            {% set method = "connect" %}
            {% set params = token %}
        {% endif %}

        $chan.call({
            method: "{{ method }}",
            params: "{{ params }}",
            success: function (r) {
                if (r) {
                    window.close();
                }
            }
        });
    </script>
{% endblock %}
