{% extends 'base.iframe.html.twig' %}

{% block body %}
{% endblock %}

{% block javascripts %}
    <script>
        var $chan = Channel.build({
            window: window.opener,
            origin: "*",
            scope: "CAS.Scope"
        });

        {% if action %}
            $chan.call({
                method: "error",
                params: "{{ action }}",
                success: function (r) {
                    window.close();
                }
            });
        {% else %}
            $chan.call({
                method: "connect",
                params: "{{ token }}",
                success: function(result) {
                    if (result) {
                        window.close();
                    }
                }
            });
        {% endif %}
    </script>
{% endblock %}
